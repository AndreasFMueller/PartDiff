%
% equations.tex
%
% (c) 2019 Prof Dr Andreas Mueller
%
\rhead{Partial differential equations}
\section{Partial differential equations%
\label{klassifikation:differentialgleichungen}}
A partial differential equation links values 
$u(x_1,\dots,x_n)$
to the values of partial derivatives
\begin{equation}
\frac{\partial u}{\partial x_1},
\frac{\partial u}{\partial x_2},
\dots,
\frac{\partial u}{\partial x_n},
\frac{\partial^2 u}{\partial x_1^2},
\frac{\partial^2 u}{\partial x_1\partial x_2},\dots,
\frac{\partial^2 u}{\partial x_1\partial x_n},\dots,
\frac{\partial^2 u}{\partial x_n^2},
\frac{\partial^3 u}{\partial x_1^3},\dots,
\frac{\partial^3 u}{\partial x_{i_1}\partial x_{i_2}\partial x_{i_3}},\dots
\label{ableitungen}
\end{equation}
In the case of a single independent variable, there is only a single
derivative of each order.
For $n$ independent variables, the number of derivatives of order $k$
increases to $n^k$, although many of the mixed derivatives will be
equal.

We have a partial differential equation as soon as we know how to
link the various derivatives.
In the example of the wave equation of the form
\begin{equation}
\frac{\partial^2 u}{\partial x_1^2}
-
c^2\frac{\partial^2 u}{\partial x_2^2} = 0,
\label{wellengleichung-tform}
\end{equation}
we have combine the second derivatives 
\[
\frac{\partial^2 u}{\partial x_1^2}
\qquad
\text{und}
\qquad
\frac{\partial^2 u}{\partial x_2^2}
\]
linearly, all the other derivatives in the list
\eqref{ableitungen}
are not used.
If we write
\[
F(t_{11}, t_{22}) = t_{11} -c^2t_{22},
\]
then the wave equation
\eqref{wellengleichung-tform}
gets the form
\[
F\biggl(
\frac{\partial^2 u}{\partial x_1^2},
\frac{\partial^2 u}{\partial x_2^2}
\biggr)=0.
\]
Here we have a function $F$ that completely specifies how the
derivatives have to be combined to give the differential equation.

The function $F$ could, however, be much more involved.
E.~g.~it could also depend on the independent variables
$x_1,\dots,x_n$, the values $u(x_1,\dots,x_n)$ of the function
or on other derivatives.
And the dependence could be more complicated than just linear as
in this example.

More generally, a partial differential equation is given by a function
\[
F(x_1,\dots,x_n,u,\dots\text{variables for partial derivatives of $u$}\dots).
\]
The differential equation is obtained by substituting the unknown function $u$
and the partial derivatives into $F$ and setting it equal to $0$:
\[
F\biggl(x_1,\dots,x_n,u(x_1,\dots,x_n),\dots,
\frac{\partial^k u}{\partial x_{i_1}\partial x_{i_2}\dots \partial x_{i_k}},\dots\biggr)=0.
\]
A often used convention for the variables is to name the variables that
stand for first derivatives as $p_i$ and variables that stand for second
derivatives as $t_{ij}$.

\begin{beispiel}
We want to find the function $F$ for the heat equation
\[
\frac{\partial u}{\partial t}=\kappa\frac{\partial^2 u}{\partial x^2}.
\]
First we have to identify the independent variables: let's write 
$x_1$ for $t$ and $x_2$ for $x$.
Then the equation becomes
\[
\frac{\partial u}{\partial x_1}
=
\frac{\partial^2u}{\partial x_2^2}.
\]
Now we have to define variables for the partial derivatives.
In accordance with a convention which we will adopt later, we write
\[
p_1 = \frac{\partial u}{\partial x_1}
\qquad\text{and}\qquad
t_{22} = \frac{\partial u}{\partial x_2^2}.
\]
With these definitions, the function $F$ becomes
\[
F(p_1, t_{22})= p_1 - \kappa t_{22}.
\qedhere
\]
\end{beispiel}

\subsection{Order\label{klassifikation:ordnung}}
\index{order}
As for ordinary differential equations, the {\em order} of a partial
differential equation is the order of the
highest derivative that appears in the differential equation.

\subsubsection{Partial differential equations of first order}
In a partial differential equation of first order, only the first derivatives
show up.
It can therefore be written in the form
\[
F\biggl(x_1,\dots,x_n, u, \frac{\partial u}{\partial x_1},\dots,\frac{\partial u}{\partial x_n}\biggr)=0.
\]
A partial differential equation of first order becomes equivalent to
a function
$F(x_1,\dots,x_n,u,p_1,\dots,p_n),$
where the substitution
\[
p_i\to \frac{\partial u}{\partial x_i}
\]
is applied.

For partial differential equations of first order with to variables,
we usually write
$F(x,y,u,p,q)$,
with the substitutions
\[
p\to\frac{\partial u}{\partial x},
\qquad
q\to\frac{\partial u}{\partial y}.
\]

\subsubsection{Partial differential equations of second order}
In the first chapter we have seen that partial differential equations of
first order are of prime importance.
Such a partial differential equation contains first and second derivatives.
Since the solution function must be differentiable, the second derivatives
do not depend on the order in which they are executed, i.~e.
\[
\frac{\partial^2 u}{\partial x_i\partial x_j}
=
\frac{\partial^2 u}{\partial x_j\partial x_i}
\quad\forall i,j
\]
The differential equation can be written as
\[
F\biggl(x_1,\dots,x_n,u,
\frac{\partial u}{\partial x_1},\dots,\frac{\partial u}{\partial x_n},
\frac{\partial^2 u}{\partial x_1^2},\dots,\frac{\partial^2 u}{\partial x_n^2}\biggr)
\]
with the function
\[
F(x_1,\dots,x_n,u,p_1,\dots,p_n,t_{11},t_{12},\dots,t_{n,n-1},t_{nn})
\]
in the variables $x_i$, $u$, $p_i$ and $t_{ij}$.
The substitution
\[
p_i\to \frac{\partial u}{\partial x_i}
,\quad
t_{ij}\to \frac{\partial^2 u}{\partial x_i\partial x_j}
\]
turns the Function $F$ into the differential equation.

The examples of partial differential equations discussed in chapter~1
correspond to the following functions:
\begin{align*}
F(t_{11},\dots,t_{nn})&=t_{11}-a^2(t_{22}+\dots+t_{nn})&&\text{wave equation}
\\
F(p_1,t_{22},\dots,t_{nn})&=p_1-\kappa(t_{22}+\dots+t_{nn})&&\text{heat equation}
\\
F(t_{11},\dots,t_{nn})&=t_{11}+\dots+t_{nn}&&\text{Poisson problem}
\end{align*}

\subsection{*Multiindices and higher partial derivatives
\label{klassifikation:multiindizes}}
In the previous section we required mixed partial derivatives.
The usual notation
\[
\frac{\partial^k u}{\partial x_{i_1}\partial x_{i_2}\dots\partial x_{i_k}}
\]
quickly becomes cumbersome.
The only information needed are the indices of the variables with respect
to which the derivative is taken, not even the order is necessary.
The notation of multiindices that we summarize in this section takes
this into account.
\begin{definition}
We call
${\bf k}=(k_1,\dots,k_n)$ a {\em multiindex} of length $n$.
\end{definition}

\begin{definition}
The {\em degree} of this multiindex is $|{\bf k}|=k_1+\dots+k_n$.
\end{definition}
With this notation, we can write terms that often appear in multivariate
analysis much more compactly:
\begin{align*}
x^{\mathbf k}&=x_1^{k_1}x_2^{k_2}\dots x_n^{k_n}\\
\partial_{\mathbf k}u
&=\frac{\partial^{k_1}}{\partial x_1^{k_1}}\dots
\frac{\partial^{k_n}}{\partial x_n^{k_n}}u
=\frac{\partial^{|{\mathbf k}|}}{\partial x_1^{k_1}\dots\partial x_n^{k_n}}u
=D^{\mathbf k}u=D_1^{k_1}D_2^{k_2}\dots D_n^{k_n}u
\end{align*}
Of course we can use multiindices also in other contexts.
As an example, a multivariate power series can be written as
\[
f(x_1,\dots,x_n)=\sum_{\mathbf k}a_{\mathbf k}x^{\mathbf k},
\]
where $a_{\mathbf k}\in\mathbb R$ are the coefficients of the power series.

A partial differential equation of order $m$ with $n$ independent variables
now corresponds to a function
\begin{align*}
F&\colon \mathbb R^n\times \mathbb R^{\{{\mathbf k}|\,|{\mathbf k}|\le m\}} \to \mathbb R
\\
&\colon(x_1,\dots,x_n,u, \dots)\mapsto F(x_1,\dots,x_n,u,\dots)
\end{align*}
The function has arguments $x_1,\dots,x_n$, $u$ and an argument for
each multiindex of degree $\le m$.
The smallest multiindex is
$(0,\dots,0)$, it corresponds to the function $u$.
For the argument with
multiindex ${\mathbf k}$ we must substitute the derivative with
this same multiindex.
Die first multiindices are
\[
(1,0,\dots,0), (0,1,\dots,0),\dots, (0,\dots, 0,1),
\]
the corresponding derivatives are the first partial derivatives:
\[
F(x_1,\dots,x_n,u,\partial_1 u,\dots,\partial_2 u,\dots)=0.
\]

\subsection{Conversion to lower order\label{klassifikation:umwandlung}}
As with ordinary differential equations, partial differential equations
of order $>1$ can be convert to a system of partial differential equations
of lower order.
We quickly recall the procedure for ordinary differential equations
and then explain what changes for partial differential equations.

The ordinary differential equation
\[
F(x,y,y',y'',\dots,y^{(n)})=0
\]
can be reduced by introducing additional functions 
$y_0,\dots,y_{n-1}$
that satisfy the equations
\begin{equation}
\begin{aligned}
\frac{dy_0}{dx}&=y_1\\
\frac{dy_1}{dx}&=y_2\\
&\vdots\\
\frac{dy_{n-2}}{dx}&=y_{n-1}\\
F\biggl(x,y_0,y_1,y_2,\dots,\frac{dy_{n-1}}{dx}\biggr)&=0
\end{aligned}
\label{classification:reduced}
\end{equation}
By setting $y_0=y$ we find
$y_k=y^{(k)}$ for each $k$, and by substituting that into the last
equation, we recover the original differential equation
$F(x,y,y',y'',\dots,y^{(n)})=0$.
The first order system \eqref{classification:reduced} is equivalent to the
original differential equation.

Now consider the partial differential equation of second order with
the two independent variables $x$ and $y$
\[
F\biggl(x,y,u,\frac{\partial u}{\partial x},\frac{\partial u}{\partial y},
\frac{\partial^2 u}{\partial x^2},\frac{\partial^2 u}{\partial x\,\partial y},
\frac{\partial^2u}{\partial y^2}\biggr)=0.
\]
Following the method for ordinary differential equations, we need new
functions that stand for the derivatives, we call them $p(x,y)$ und $q(x,y)$.
We have to express that these functions are in fact partial
derivatives of the function $u$, this gives us the two additional partial
differential equations
\[
p=\frac{\partial u}{\partial x},\qquad q=\frac{\partial u}{\partial y}.
\]
We can also express the second partial derivatives using these variables:
\begin{align*}
\frac{\partial^2 u}{\partial x^2}&=\frac{\partial p}{\partial x}\\
\frac{\partial^2 u}{\partial x\,\partial y}&=\frac{\partial p}{\partial y}=\frac{\partial q}{\partial x}\\
\frac{\partial^2 u}{\partial y^2}&=\frac{\partial q}{\partial y}
\end{align*}
Since we consider $p$ and $q$ as independent functions, and not as
derivatives of the same function, it is not automatically clear that 
the mixed derivatives are the same, so we have to add the equation
\[
\frac{\partial p}{\partial y}
=
\frac{\partial q}{\partial x}.
\]
This gives us the following system of partial differential equations
of first order
\begin{align*}
F\biggl(x,y,u,p,q,\frac{\partial p}{\partial x},\frac{\partial p}{\partial y},\frac{\partial q}{\partial y}\biggr)&=0\\
p&=\frac{\partial u}{\partial x}\\
q&=\frac{\partial u}{\partial y}\\
\frac{\partial p}{\partial y}&=\frac{\partial q}{\partial x}
\end{align*}
Thus we have reduced a partial differential equations of second order
to a system of partial differential equations of first order for 
the three unknown functions $u$, $p$ and $q$.

It becomes obvious that this reduction procedure leads to an inflation of
new unknown functions and additional equations for all the mixed
derivatives.
So while the reduction to first order is the primary method to make
ordinary differential equations amenable to numeric solutions with the
help of computers, this procedure is hardly useful for the numeric
solution of partial differential equations.
The solution algorithms for second order partial differential equations
discussed in the second part of this course do not use it and instead
are based on the properties of these equations.

