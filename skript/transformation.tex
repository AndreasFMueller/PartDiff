%
% transformation.tex
%
% (c) 2008 Prof Dr Andreas Mueller, Hochschule Rapperswil
% $Id: c03-transformation.tex,v 1.4 2008/10/31 08:04:16 afm Exp $
%
\chapter{Transformation}
\lhead{Transformation}
Bei der Lösung gewöhnlicher linearer Differentialgleichungen lieferte die
Laplacetransformation eine hervorragende Methode, mit der sehr
viele Anfangswertprobleme gelöst werden konnten.
In diesem Kapitel wird gezeigt, wie diese Methode wie auch
Fouriertransformation oder Fourierreihen 
für lineare partielle Differentialgleichungen nutzbar gemacht
werden können.

\section{Einführungsbeispiel}
\subsection{Wellengleichung für die schwingende Saite}
\rhead{Schwingende Saite}
Zur Einführung betrachten wir erneut das Beispiel der
schwingenden Saite mit der Gleichung
\[
\partial_t^2u=\partial_x^2u.
\]
Durch einen Separationsansatz hatten wir dieses Problem
darauf zurückgeführt, Gleichungen $X''=-k^2X$ und $T''=-k^2T$
zu lösen.
Dabei haben wir die harmonischen Funktionen wieder gefunden,
mit Hilfe der Fouriertheorie ist sodann die Bestimmung einer Lösung
gelungen.

Andererseits könnten wir auch mit der Fouriertheorie beginnen und
verwenden, dass sich eine Funktion auf dem Interval $[0,\pi]$
durch Spiegelung zu einer periodischen Funktion auf $[-\pi,0]$
erweitern lässt. Indem wir zu jedem Zeitpunkt $t$ eine Fourieranalyse
durchführen, lässt sich die Funktion $x\mapsto u(t,x)$ als
Fourierreihe 
\[
u(t,x)=\frac{a_0(t)}2+\sum_{k=1}^\infty a_k(t)\cos kx+b_k(t)\sin kx
\]
mit zeitabhängigen Koeffizienten schreiben.
Setzen wir diesen Ansatz in die Differentialgleichung ein, ergibt sich
\begin{align*}
\partial_t^2u(t,x)&=\frac{a_0''(t)}2
+\sum_{k=1}^\infty a_k''(t)\cos kx+b_k''(t)\sin kx\\
\partial_x^2u(t,x)&=
-\sum_{k=1}^\infty a_k(t)k^2\cos kx+b_k(t)k^2\sin kx
\end{align*}
Wenn diese Funktionen gleich sein sollen, muss
\[
\frac{a_0''(t)}2
+\sum_{k=1}^\infty (a_k''(t)+k^2a_k(t))\cos kx+(b_k''(t)+k^2b_k(t))\sin kx=0
\]
gelten. Nach der Fourier-Theorie ist dies nur möglich, wenn die
Fourier-Koeffizienten alle verschwinden:
\begin{align*}
a_0''(t)&=0\\
a_k''(t)&=-k^2a_k(t)\\
b_k''(t)&=-k^2b_k(t)
\end{align*}
mit $k>0$.
Wir haben also durch Übergang zu Fourierkoeffizienten ein System
von gewöhnlichen Differentialgleichungen für die Fourier-Koeffizienten
gefunden. Die Lösungen sind wohl bekannt:
\begin{align*}
a_0(t)&=m_0t+c_0\\
a_k(t)&=A^a_k\cos kt+B^a_k\sin kt\\
b_k(t)&=A^b_k\cos kt+B^b_k\sin kt\\
\end{align*}
Dies entspricht den Lösungen, die wir bereits im vorangegangenen
Kapitel gefunden haben.

\subsection{Anfangsbedingungen}
Die Differentialgleichungen für die Koeffizienten $a_k(t)$ und $b_k(t)$
können erst dann vollständig gelöst werden, wenn Anfangs oder Randbedingungen
gegeben sind. Sei also zusätzlich zur Wellengleichung die Anfangsbedingung
\begin{align*}
u(0,x)&=f(x)\\
\frac{\partial u}{\partial t}&=g(x)
\end{align*}
gegeben. auch die Funktionen $f$ und $g$ können duch eine Fourierreihe
dargestellt werden, werden wir schreiben
\begin{align*}
f(x)&=\frac{a_0^f}2+\sum_{k=1}^\infty a_k^f\cos kx+b_k^f\sin kx\\
g(x)&=\frac{a_0^g}2+\sum_{k=1}^\infty a_k^g\cos kx+b_k^g\sin kx
\end{align*}
Zusammen mit dem Ansatz für $u(t,x)$ als Fourierreihe finden wir jetzt
die Bedingungen für $t=0$
\begin{align*}
\frac{a_0(0)}2+\sum_{k=1}^\infty a_k(0)\cos kx +b_k(0)\sin kx
&=
\frac{a_0^f}2+\sum_{k=1}^\infty a_k^f\cos kx+b_k^f\sin kx\\
\\
\frac{a_0'(0)}2+\sum_{k=1}^\infty a_k'(0)\cos kx+b_k'(0)\sin kx
&=
\frac{a_0^g}2+\sum_{k=1}^\infty a_k^g\cos kx+b_k^g\sin kx
\end{align*}
Koeffizientenvergleich liefert jetzt die Anfangsbedingungen für die
Funktionen $a_k$ und $b_k$:
\begin{align*}
a_k(0)&=a_k^f&b_k(0)&=b_k^f\\
a_k'(0)&=a_k^g&b_k'(0)&=b_k^g\\
\end{align*}
Zusammen mit den früher gefundenen Lösungen gilt also
\begin{align*}
c_0&=a_0^f&&&A_k^a&=a_k^f&&&&&A_k^b&=b_k^f\\
m_0&=a_0^g&&&kB_k^a&=a_k^g&\Rightarrow B_k^a&=\frac1ka_k^g&&&kB_k^b&=b_k^g&\Rightarrow B_k^b&=\frac1kb_k^g
\end{align*}
Die vollständige Lösung ist damit
\begin{align*}
u(t,x)=\frac{a_0^gt+a_0^f}2
+\sum_{k=1}^\infty
\biggl(a_k^f\cos kt+\frac1ka_k^g\sin kt\biggr)\cos kx
+
\biggl(b_k^f\cos kt+\frac1kb_k^g\sin kt\biggr)\sin kx.
\end{align*}

\subsection{Inhomogene Wellengleichung}
Das Verfähren lässt sich auch die inhomogene Wellengleichung
\[
\partial_t^2u-\partial_x^2u=f
\]
verallgemeinern. Die Funktion $f(t,x)$ lässt sich natürlich ebenso wie
$u$ als Fourierreihe entwickeln:
\[
f(t,x)=\frac{a_0^f(t)}2+\sum_{k=1}^\infty a_k^f(t)\cos kx+b_k^f(t)\sin kx.
\]
Setzt man dies zusammen mit der Entwicklung für $u(t,x)$ in die
Differentialgleichung ein, findet man die Gleichungen
\begin{align*}
a''_k(t)+k^2a_k(t)&=a_k^f(t)\\
b''_k(t)+k^2b_k(t)&=b_k^f(t),
\end{align*}
also ein System von gewöhnlichen inhomogenen linearen Differentialgleichungen.

\subsection{Lehren aus dem Einführungsbeispiel}
Durch die Transformation auf die Fourier-Koeffizienten verschwindet die
Ableitung nach $x$,  stattdessen bleibt nur noch eine gewöhnliche
Differentialgleichung, die zweifache Ableitung nach $x$ wurde zur
algebraischen Operation der Multiplikation mit $-k^2$. Diese Transformation
war möglich, weil der $x$-Definitionsbereich ein Interval war.
Für andere Definitionsbereiche wird die Fourier-Transformation nicht
geeignet sein.

\section{Laplace-Transformation Crash-Course}
Für $[0,\infty[$ als Definitionsbereich ist die Laplace-Transformation
die geeignete Transformation. Dieser Abschnitt enthält einen Kurzabriss
der wesentlichen Ideen der Theorie der Laplace-Transformation.
Für uns wesentlich ist dabei, dass die Transformation die Ableitungen
in algebraische Operationen umwandelt. Eine algebraische Gleichung ist
einfacher zu lösen, die Rücktransformation liefert daraus die Lösung.

\subsection{Definition}
\begin{definition}
Die Laplace-Transformierte ${\cal L}f$ einer Funktion
$f\colon[0,\infty)\to\mathbb R$ ist die Funktion
\[
({\cal L}f)(s)=\int_0^\infty f(t)e^{-st}\,dt.
\]
\end{definition}
Offenbar ist ${\cal L}f$ für beliebige beschränkte Funktionen $f$ definiert.

\subsection{Beispiele}
Drei Beispiele sollen das Rechnen mit der Laplace-Transformation
illustrieren.
\begin{enumerate}
\item
Sei $f(t)=c$ eine konstante Funktion. Die Laplace-Transformation
\[
({\cal L}f)(s)
=
\int_0^\infty ce^{-st}\,dt
=
\left[
-\frac{c}{s}e^{-st}
\right]_0^\infty=\frac{c}{s}.
\]

\item
Sei jetzt $f(t)=e^{-kt}$, die Laplace-Transformation ist
\[
({\cal L}f)(s)=\int_0^\infty e^{-kt}e^{-st}\,dt
=\int_0^{\infty}e^{-(s+k)t}\,dt
=
\left[
- \frac1{s+k}e^{-(s+k)t}
\right]_0^\infty
=\frac1{s+k}.
\]

\item
Wir berechnen jetzt die Laplace-Transformierte einer Ableitung, also
$({\cal L}f')(s)$:
\begin{align*}
({\cal L}f')(s)
&=
\int_0^\infty f'(t)e^{-st}\,dt
\\
&=
\left[f(t)e^{-ts}\right]_0^\infty
+
\int_0^\infty sf(t)e^{-st}\,dt
\\
&=
-f(0)+s\int_0^\infty f(t)e^{-st}\,dt
\\
&=s({\cal L}f)(s)-f(0).
\end{align*}
Wie versprochen wandelt die Laplace-Transformation die Ableitung
ein eine algebraische Operation um.
\end{enumerate}

\subsection{Lösung einer gewöhnlichen Differentialgleichung}
Wir lösen die Differentialgleichung
\[
\dot x(t)+px(t)=f(t)
\]
mit der Anfangsbedingung $x(0)=0$.
Die Laplace-Transformation der Differentialgleichung ist
\[
s({\cal L}x)(s)-x(0)+p({\cal L}x)(s)=({\cal L}f)(s).
\]
Zu bestimmen ist $x$, diese Gleichung ist eine algebraische Gleichung
für ${\cal L}x$, die man auch nach ${\cal L}x$ auflösen kann:
\[
({\cal L}x)(s)
=
\frac{({\cal L}f)(s)}{s+p}
\]
Um zu zeigen, wie mit dieser Methode die vollständige Lösung gefunden
werden kann, führen wir die Rücktransformation für $f(t)=q$ durch.
Zunächst ist in diesem Fall
\[
({\cal L}f)(s)=\frac{q}{s}
\]
und damit 
\[
({\cal L}x)(s)
=
\frac{q}{s(s+p)}=\frac{q}{p}\frac{1}{s}-\frac{q}{p}\frac{1}{s+p}
\]
Beide Termen auf der rechten Seite können mit den Beispielen im vorangegangenen
Abschnitt rücktransformiert werden:
\[
x(t)=\frac{q}{p}-\frac{q}{p}e^{-pt}=\frac{q}{p}(1-e^{-pt}).
\]

\subsection{Lösung einer partiellen Differentialgleichung}
Dieses Verfahren funktioniert auch für partielle Differentialgleichungen.
Als Beispiel lösen wir die quaslineare Differentialgleichung
\[
\frac{\partial u}{\partial t}+x\frac{\partial u}{\partial x}=x
\]
$u$ ist definiert für $t\ge0$, $x\ge 0$ und wir verlangen die Randbedingungen
\begin{align*}
u(x,0)&=0\qquad x>0\\
u(0,t)&=0\qquad t>0\\
\end{align*}
Die Laplacetransformation der Differentialgleichung ist
\[
s({\cal L}u)(s,x)-u(0,x)+x\frac{\partial}{\partial x}({\cal L}u)(s,x)=\frac{x}{s},
\]
sie hat die Ableitung nach der Zeit zum Verschwinden gebracht. Für jedes
$s$ kann man dies als eine gewöhnliche Differentialgleichung für die
Funktion $x\mapsto ({\cal L}u)(s,x)$ mit der Anfangsbedingung
$({\cal L}u)(s,0)=0$ betrachten.
Die Lösung mit den Standardmethoden 
ergibt
\[
({\cal L}u)(s,x)=\frac{x}{s(s+1)}=\frac{x}{s}-\frac{x}{s+1}.
\]
Beide Terme können rücktransformiert werden, die Lösung ist
\[
u(t,x)=x-xe^{-t}=x(1-e^{-t}).
\]
Wir berechnen zur Kontrolle die Ableitungen
\begin{align*}
\frac{\partial u}{\partial t}
&=
xe^{-t}
\\
\frac{\partial u}{\partial x}
&=
1-e^{-t},
\end{align*}
damit 
\[
xe^{-t}+x(1-e^{-t})=x,
\]
die Differentialgleichung ist also erfüllt, und wegen
\begin{align*}
u(x,0)
&=
0
\\
u(0,t)
&=
0
\end{align*}
sind auch die Randbedingungen erfüllt.

\section{Wärmeleitung auf einem Kreis}
\rhead{Wärmeleitung}
Wir betrachten jetzt die Wärmeleitungsgleichung auf einem Drahtring
mit gegebenen Anfangswerten. Die Temperaturverteilung auf dem
Kreis beschreiben wir als eine periodische Funktion auf dem Interval
$[-\pi,\pi]$. Gesucht ist daher eine Lösung der Wärmelteitungsgleichung
mit den Anfangsbedingungen
\begin{align*}
\partial_t u(t,x)&=\partial_x^2 u(t,x) &&\forall(t,x)\in\mathbb R\times[-\pi,\pi]\\
u(0,x)&=f(x)&& \forall x\in[-\pi,\pi]\\
\end{align*}

\subsection{Fouriertransformation auf dem Interval}
Wie im einführenden Beispiel gehen wir jetzt zu Fourierkoeffizienten
über.
Der Einfachheit halber verwenden wir komplexe Fourierkoeffizienten
\[
c_k=\hat f(k)=\frac1{2\pi}\int_{-\pi}^{\pi}e^{-ikx}f(x)\,dx
\]
Wenden wir die Transformation auf die ursprüngliche Differentialgleichung
an, erhalten wir
\begin{align}
\frac1{2\pi}\int_{-\pi}^{\pi}e^{-ikx}\partial_t u(t,x)\,dx
&=\frac1{2\pi}\int_{-\pi}^{\pi}e^{-ikx}\partial_x^2 u(t,x)\,dx
\notag
\\
\partial_t\frac1{2\pi}\int_{-\pi}^{\pi}e^{-ikx} u(t,x)\,dx
&=
\frac1{2\pi}
\underbrace{
\left[
e^{-ikx}\partial_x u(t,x)
\right]_{-\pi}^{\pi}}_{=0}
+
ik\frac1{2\pi}\int_{-\pi}^{\pi}e^{-ikx}\partial_x u(t,x)\,dx
\notag
\\
&=
0 + 
ik\frac1{2\pi}
\underbrace{
\left[
e^{-ikx}u(t,x)
\right]_{-\pi}^{\pi}}_{=0}
-
k^2\frac1{2\pi}\int_{-\pi}^{\pi}e^{-ikx} u(t,x)\,dx
\notag
\\
&=
-
k^2\frac1{2\pi}\int_{-\pi}^{\pi}e^{-ikx} u(t,x)\,dx
\notag
\\
\partial_t\hat u(t,k)&=-k^2 \hat u(t,k)
\label{fouriertransformiert}
\end{align}
Aus der partiellen Differentialgleichung ist ein System von gewöhnlichen
Differentialgleichungen für $t\ge 0$ geworden.

\subsection{Laplacetransformation}
Durch Laplace-Transformation der Gleichung (\ref{fouriertransformiert})
erhalten wir die Gleichung
\begin{align*}
\int_0^{\infty} \partial_t \hat u(t,k)e^{-st}\,dt
&=
-k^2\int_0^{\infty}\hat u(t,k)e^{-st}\,dt
\\
\left[\hat u(t,k)e^{-st}\right]_0^{\infty}
+
s\int_0^{\infty}\hat u(t,k)e^{-st}\,dt
&=
-k^2{\cal L}\hat u(s,k)
\\
\hat u(0,k)-s{\cal L}\hat u(s,k)&=k^2{\cal L}\hat u(s,k).
\\
{\cal L}\hat u(s,k)&=\frac{\hat u(0,k)}{s+k^2}
\end{align*}

\subsection{Rücktransformation}
Um die allgemeine Lösung der Differentialgleichung zu finden,
muss man jetzt rücktransformieren, zunächst nach Laplace:
\begin{align*}
\hat u(t,k)&={\cal L}^{-1}\left(\frac1{s+k^2}\right)\hat u(0,k)
\\
&=e^{-k^2t}\hat u(0,k)
\end{align*}
und dann auch noch nach Fourier, also durch Bilden der Fourierreihe
\begin{align*}
u(t,x)&=\sum_{k\in\mathbb Z}e^{-k^2t}\hat u(0,k)e^{ikx}
\\
&=\sum_{k\in\mathbb Z}\hat u(0,k)e^{ikx-k^2t}
\end{align*}

\section{Diffusion}
\rhead{Diffusion}
Wir betrachten jetzt die Diffusionsgleichung auf der Halbebene
$(t,x)\in[0,\infty)\times \mathbb R$
\[
\partial_tu-\partial_x^2u=f(t,x)
\]
mit den Anfangsbedingungen
\[
u(0,x)=g(x)\quad \forall x\in\mathbb R.
\]
Wir wenden jetzt die jeweils an den Definitionsbereich angepasste
Transformation durch.

\subsection{Fouriertransformation}
Die Fouriertransformation für eine Funktion $g(x)$ von $x$ ist
\[
\hat g(k)=\frac1{\sqrt{2\pi}}\int_{\mathbb R}g(x)e^{-ikx}\,dx.
\]
Die Fouriertransformation macht aus den gegebenen Gleichungen
\begin{align*}
\partial_t \hat u(t,k)+k^2\hat u(t,k)&=\hat f(t,k)\\
\hat u(0,k)&=\hat g(k)
\end{align*}

\subsection{Laplace-Transformation}
In $t$-Richtung wenden wir eine Laplace-Transformation an
\[
-\hat u(0,k)+(s+k^2){\cal L}\hat u(s,k)={\cal L}\hat f(s,k)
\]
Diese Gleichung kann nach ${\cal L}\hat u(s,k)$ auflösen:
\[
{\cal L}\hat u(s,k)=\frac{\hat u(0,k)+{\cal L}\hat f(s,k)}{s+k^2}
\]

\subsection{Lösung des Anfangswertproblems}
Durch Rücktransformation können jetzt auch die Lösungen wieder
gewonnen werden.
\begin{align*}
\hat u(t,k)&={\cal L}^{-1}
\frac{\hat u(0,k)+{\cal L}\hat f(s,k)}{s+k^2}
\\
u(t,x)&={\cal F}^{-1}{\cal L}^{-1}
\left(\frac{\hat u(0,k)+{\cal L}\hat f(s,k)}{s+k^2}\right)(t,x)
\end{align*}

\section{Transformation bei beliebigen Gebieten}
Mit Hilfe von Integraltransformationen können partielle
Differentialgleichungen  gelöst werden, wenn die Transformation
an das Definitionsgebiet angepasst ist:
\begin{center}
\begin{tabular}{cl}
Definitionsgebiet&Transformation\\
\hline
$[0,\infty)$&Laplacetransformation\\
$\mathbb R$&Fouriertransformation\\
$[-\pi,\pi]$&Fourierreihen
\end{tabular}
\end{center}
Die Separationsmethode zeigt uns aber auch, wie dieses 
Verfahren verallgemeinert werden kann. Die Wärmeleitungsgleichung
soll auf einem Gebiet $G\subset \mathbb R^n$ gelöst werden, d.~h.~es
soll eine Lösung der Differentialgleichung
\[
\partial_t u(t,x)=\Delta u(t,x)
\]
gefunden werden für $(t,x)\in [0,\infty)\times G$ mit der Anfangsbedingung
\[
u(0,x)=u_0(x) \quad x\in G
\]
und der Randbedingung
\[
au(t,x)+b\partial_nu(t,x)=0\quad (t,x)\in[0,\infty)\times \partial G
\]
gefunden werden. Kapitel \ref{chapter-separation} suggeriert, dass
es eine Familie von Funktionen $u_k(x)$ gibt, die der Gleichung
\[
\Delta u_k=\lambda_k u_k
\]
und der Randbedingung genügen, und mit denen sich die 
Anfangsbedingung als Reihe schreiben lässt:
\[
u_0(x)=\sum_{k=1}^\infty a_ku_k(x).
\]
Dann kann man die Lösung der Wärmeleitungsgleichung sofort
hinschreiben:
\[
u(t,x)=\sum_{k=1}e^{-\lambda_kt}u_k(x)
\]
Die Funktionen spielen die Rolle von $e^{ikx}$ in der Fouriertheorie.

Die moderne Mathematik kennt eine allgemeine Theorie der harmonischen
Analyse auf sogenannten Lie-Gruppen, welche die Fourier- und 
Laplace-Theorie verallgemeinert und vereinheitlicht, und welche
weitere Gebiete zu behandeln erlaubt. Zum Beispiel ermöglicht
die Entwicklung von Funktionen auf einer ($n$-dimensionalen)
Kugel mit sogenannten Kugelfunktionen die Idee der Fourierreihen
auf einem Interval auf höherdimensionale Gebiete zu verallgemeinern.

\section{Zusammenfassung: das Wichtigste in Kürze}
\begin{enumerate}
\item Der Übergang von Funktionen zu Fourierreihen verwandelt
eine partielle Differentialgleichung in eine Famile gewöhnlicher
Differentialgleichung für die einzelnen Fourier-Koeffizienten.
\item Integraltransformationen können ein partielle Differentialgleichung
in eine Familie partieller Differentialgleichungen mit weniger Variablen
oder sogar gewöhnlicher Differentialgleichungen verwandeln.
\item Integraltransformationen und die Rücktransformationen können
Formeln für die Lösungen gewisser partieller Differentialgleichungen
liefern, und damit die Frage beantworten, für welche Randwertvorgaben
die Gleichungen gut gestellt sind.
\end{enumerate}
